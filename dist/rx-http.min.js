!function(e,t){"function"==typeof define&&define.amd?define(["rx"],t):"object"==typeof exports?module.exports=t(require("rx")):e.RxHttp=t(e.Rx)}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){function t(e){var t={};return Object.keys(e).forEach(function(r){t[r]=n(e[r])}),t}function n(e){return Array.isArray(e)?e.map(n):"object"===("undefined"==typeof e?"undefined":u(e))?t(e):e}return n(e)}function r(e){function t(e){var t=void 0;return function(){return void 0===e&&(t="function"==typeof e?e():e),t}}var n=this;this.status=t(e.status),this.statusText=t(e.statusText),this.headers=t(e.getAllResponseHeaders()),this.header=function(e){return n.headers()[e]},this.body=t(function(){})}function o(e){var t=this;this.timeout=function(){return t.options.timeout},this.retries=function(){return t.options.retries},this.method=function(){return e.method},this.url=function(){return e.url},this.body=function(){return e.body},this.header=function(t){return e.headers[t]},this.headers=function(){return Object.assign({},e.headers)},this.query=function(n){return void 0===n?Object.assign({},e.query):t.options.query[n]},this.execute=function(){return e.provider(t)}}function i(t){function n(e,t,n){var i=function(e){return function(n){t.onNext({type:e,progress:n})}},s=function(e){n>0?o(t,n-1):(t.onError(e),t.onCompleted())};e.upload&&(e.upload.addEventListener("progress",i(d.UPLOAD_PROGRESS)),e.upload.addEventListener("error",s),e.upload.addEventListener("abort",s)),e.addEventListener("progress",i(d.DOWNLOAD_PROGRESS)),e.addEventListener("error",s),e.addEventListener("abort",s),e.addEventListener("load",function(n){var o=new r(e);t.onNext({type:d.RESPONSE_RECEIVED,response:o})})}function o(e){var r=arguments.length<=1||void 0===arguments[1]?t.retries():arguments[1],o=new window.XmlHTTPRequest;n(o,e,r),o.open(t.method(),t.url()),t.timeout()&&"number"==typeof t.timeout()&&(o.timeout=t.timeout());var i=t.headers();Object.keys(i).forEach(function(e){o.setRequestHeader(e,i[e])}),o.send(t.body())}var i=e.Observable.create(o).share(),s=i.filter(function(e){return e.type===d.UPLOAD_PROGRESS}).map(function(e){return e.progress}),u=i.filter(function(e){return e.type===d.DOWNLOAD_PROGRESS}).map(function(e){return e.progress}),a=i.filter(function(e){return e.type===d.RESPONSE_RECEIVED}).map(function(e){return e.response});return{uploadProgress:s,downloadProgress:u,response:a}}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},d={UPLOAD_PROGRESS:"UPLOAD_PROGRESS",DOWNLOAD_PROGRESS:"DOWNLOAD_PROGRESS",RESPONSE_RECEIVED:"RESPONSE_RECEIVED"},a=["GET","POST"],f=function(e){return e},c=function(){function e(n,r,o,i){t(this,e),this.options=Object.assign({},{retries:n,timeout:r,provider:o,interceptor:i})}return s(e,[{key:"header",value:function(e,t){return void 0===t?this.options.headers[e]:(this.options.headers[e]=t.toString(),this)}},{key:"headers",value:function(e){return void 0===e?Object.assign({},this.options.headers):(this.options.headers=Object.assign({},this.options.headers,e),this)}},{key:"query",value:function(e,t){return void 0===t?"object"===("undefined"==typeof e?"undefined":u(e))?(this.options.query=e,this):this.options.query[e]:(this.options.query[e]=t.toString(),this)}},{key:"body",value:function(e){return void 0===e?this.options.body:(this.options.body=e,this)}},{key:"timeout",value:function(e){return void 0===e?this.options.timeout:(this.options.timeout=e,this)}},{key:"retries",value:function(e){return void 0===e?this.options.retries:(this.options.retries=e,this)}},{key:"build",value:function(){var e=n(this.options);return a.some(function(t){return t===e.method})||(e.method="POST",e.headers["X-HTTP-Method-Override"]=this.options.method),new o(e)}}]),e}(),p=function(){if("undefined"!=typeof process&&"undefined"!=typeof process.release&&"node"===process.release.name)throw new Error("Node.js support coming soon");return i}(),h={request:function(e,t){var n=(arguments.length<=2||void 0===arguments[2]?{}:arguments[2],{url:e,method:t,retries:h.defaults.retries,timeout:h.defaults.timeout,provider:h.defaults.provider,interceptor:h.defaults.interceptor});return new c(n)},defaults:{retries:0,timeout:3e4,interceptor:f,provider:p}};return["GET","POST","PUT","PATCH","OPTIONS","DELETE","HEAD","TRACE"].forEach(function(e,t){h[e.toLowerCase()]=function(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return h.request(t,e,n)}}),h});
//# sourceMappingURL=rx-http.min.js.map
